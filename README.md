# Vulnerability-Scan
I created A Virtual Machine environment using VMWare running Windows 10.  Showcased the VML.  Used Nessus Essentials to run credentialed scans, remediated some of the vulnerabilities, then perform a rescan to verify remediation.

##### Utilities Used
 
 - Nessus Essentials

 - CMD
 
 ##### Environments Used
 - VMWare
 - Windows 10 (21H2)

#####  Links

VMWare Workstation Pro: (https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html)

Nessus Essentials: (https://www.tenable.com/products/nessus/nessus-essentials)

Windows 10 ISO: (https://www.microsoft.com/en-us/software-download/windows10)


# Program Walk Through

 ![Alt text](https://github.com/BarryGFloyd/Vulnerability-Scan/blob/main/NESSUS%20Program%20First%20photo.jfif)

For the Virtual Machine that I will be managing vulnerabilities on, I’ll configure the network adapter to be bridged, so it can be on the same network as my native. The reason, Nessus has to Secure Server Login (SSL) into the Virtual Machine.  
I open up CMD to locate the IP address I’ll need to run vulnerability scans.  I named the VM Admin. The screenshot shows that the IP address is 192.168.50.185
 
I attempt to ping the VM from my native computer.  The reason is to confirm communication so Nessus can run scans. The pings are timing out, meaning my native PC can't establish a connection.
 
The PC can't establish connection because of the VM firewall. I have to disable the firewalls just for this lab. 









I turn off all three firewalls which are circled at the top in Red, Blue, and Green. Yellow is showing the firewalls are currently on. 

 
Now that the VM's firewall is disabled, I try to Ping it again from my native PC and this time it is successful. 











The first thing I want to do is create a new scan, then select Basic Network Scan.
  
The newly created scan asks me to name the scan and select a target to scan. I configure it to scan the VM's IP address which is 192.168.50.185
 

I launch the newly created scan and it immediately goes to work scanning for any known vulnerabilities. When the grey checkmark appears, the scan is complete. 
It shows 33 results, 32 of which are info and 1 low. If this was an actual production environment these most likely would be left alone. The Info results are probably because some things don't have proper credentials and are not essentially vulnerabilities

 

Looking at one of the INFO results you can see that the Target Credential Status By Authentication Procotol was triggered because we did not actually provide any credentials for this scan.

 

Next thing I do is configure the VM to be able to accept authenticated scans and provide credentials to Nessus. I will then rescan the VM and compare the results. I go to services. MSC to start this process and enable Remote Registry. This will allow Nessus to connect to the VM's registry and properly scan for vulnerabilities such as insecure connections or deprecated cipher suites. I'm following these steps from Nessus and what they recommend for credentialed scans. 

 

 

 

 


 

I'm going to open the registry and add a key that is supposed to allow Nessus to connect in by further disabling user account controls.

 

Now I navigate the Registry to the file that Nessus instructs us to (highlighted Yellow in the search bar) and I have to add a DWORD value and name it LocalAccountTokenFilterPolicy and give it a value of 1.

 

 

 

Restart the VM so the changes can take effect.

 

With the registry configured, it is now time to go back into Nessus and configure the scan I created. I have to add the Credentials to the scan so it can work properly. The credentials I'm talking about is the username and password of the VM. This will allow Nessus to use those credentials in places where it is required in the VM registry.

 
 
After the scan is properly configured with the right credentials, I run it again.
 

This new scan has given us a lot more vulnerabilities than the first one because it is able to scan deeper into the VM due to having credentials. The top picture is the new credentialed scan and the bottom picture is from the first non-credentialed scan. Most of the vulnerabilities found are probably because the version of Windows 10 this VM is running is not up to date.

  

Downloaded a very old version of Firefox to see if Nessus can discover the vulnerabilities.

 

After a deprecated version of Firefox is downloaded, I run another scan and see many critical vulnerabilities.

 

To start the process of remediating vulnerabilities, I elect to just delete Firefox. That will instantly fix a lot of these issues

 

To remediate the Windows vulnerabilities, I updated Windows. 

 

 
 The final comparison between the four scans shows a lot of the vulnerabilities are gone!




